# Frontend PRD – ClearanceHub

**Product:** ClearanceHub (Cards & Access Requests)
**Audience:** Frontend Developers (React)
**Backend Reference:** backend_prd.md + OpenAPI (ClearanceHub API)

---

## 1. الهدف من الواجهة (Frontend Goal)

بناء واجهة استخدام واضحة وبسيطة تُمكّن:
- الموظفين من تقديم طلب بطاقة أو تصريح باستخدام **الرقم الوظيفي فقط**
- مدراء الأقسام من مراجعة طلبات أقسامهم والموافقة/الرفض
- قسم الأمن من مراجعة جميع الطلبات الأمنية
- قسم طباعة البطاقات من تنفيذ الطلبات المكتملة أمنيًا

> جميع منطق الصلاحيات والفلترة يتم فرضه من الباك-إند. الفرونت يلتزم فقط بالاستهلاك الصحيح للـ API.

---

## 2. أنواع المستخدمين (User Personas)

### 2.1 موظف (بدون تسجيل دخول)
- إدخال الرقم الوظيفي
- عرض بياناته (للتأكيد فقط)
- تقديم:
  - طلب بطاقة
  - طلب تصريح
- تتبع حالة الطلب

---

### 2.2 مدير قسم (DEPT_MANAGER)
- تسجيل دخول عبر Email + OTP
- الاطلاع على طلبات قسمه فقط
- إنشاء طلبات **نيابة عن موظفي القسم**
- الموافقة أو الرفض مع سبب

---

### 2.3 موظف أمن (SECURITY)
- تسجيل دخول عبر OTP
- الاطلاع على جميع الطلبات المعتمدة من المدير
- الموافقة أو الرفض مع سبب

---

### 2.4 موظف طباعة البطاقات (CARD_PRINTING)
- تسجيل دخول عبر OTP
- الاطلاع على الطلبات المعتمدة أمنيًا
- تنفيذ الطلب (طباعة / إصدار)
- إكمال الطلب (Complete)

---

## 3. الصفحات الأساسية (Screens)

### 3.1 الصفحة الرئيسية
- اختيار نوع الإجراء:
  - طلب بطاقة
  - طلب تصريح
  - تسجيل دخول (للموظفين المصرح لهم)

---

### 3.2 صفحة إدخال الرقم الوظيفي

**Fields:**
- employee_id

**Behavior:**
- Call: `GET /employees/{employee_id}`
- عرض بيانات الموظف (Read-only):
  - الاسم
  - المسمى الوظيفي
  - القسم

---

### 3.3 صفحة طلب بطاقة

**Inputs:**
- نوع الطلب (جديد / تجديد / بدل فاقد)
- سبب الطلب
- صورة (اختياري)

**Submit:**
- `POST /requests/card`

---

### 3.4 صفحة طلب تصريح

**Inputs:**
- اختيار المناطق (Multi-select)
  - Call: `GET /areas`
- سبب الطلب

**Submit:**
- `POST /requests/access`

---

### 3.5 صفحة تسجيل الدخول (OTP)

**Step 1:** إدخال البريد الداخلي
- `POST /auth/request-otp`

**Step 2:** إدخال رمز OTP
- `POST /auth/verify-otp`

---

## 4. لوحات التحكم (Dashboards)

### 4.1 Dashboard مدير القسم

**عرض:**
- قائمة طلبات القسم فقط
- أعمدة:
  - رقم الطلب
  - رقم الموظف
  - نوع الطلب
  - الحالة
  - التاريخ

**Actions:**
- عرض التفاصيل
- موافقة
- رفض (سبب إلزامي)

---

### 4.2 Dashboard الأمن

**عرض:**
- جميع الطلبات بحالة APPROVED_BY_MANAGER

**Actions:**
- موافقة
- رفض (سبب إلزامي)

---

### 4.3 Dashboard طباعة البطاقات

**عرض:**
- الطلبات بحالة APPROVED_BY_SECURITY

**Actions:**
- عرض التفاصيل
- تنفيذ الطلب
- Complete

---

## 5. صفحة تفاصيل الطلب

**Content:**
- بيانات الموظف (snapshot)
- بيانات الطلب
- Timeline الموافقات

**Call:**
- `GET /requests/{request_id}`

---

## 6. التتبع (Tracking)

- الموظف يستطيع تتبع طلبه برقم الطلب + الرقم الوظيفي
- يعرض فقط الحالة الحالية

---

## 7. الصلاحيات في الواجهة (UI Authorization)

| الدور | ما يراه في الواجهة |
|-----|------------------|
| Guest | طلب + تتبع فقط |
| DEPT_MANAGER | طلبات قسمه + إنشاء بالنيابة |
| SECURITY | جميع الطلبات الأمنية |
| CARD_PRINTING | الطلبات الجاهزة للتنفيذ |

> **مهم:** لا تعتمد على الفرونت في منع الوصول – الباك هو المصدر النهائي.

---

## 8. تجربة المستخدم (UX Rules)

- لا تُعرض حقول غير مطلوبة
- إظهار الأخطاء القادمة من API كما هي
- تعطيل الأزرار أثناء الإرسال
- تأكيد قبل الرفض أو الإكمال

---

## 9. إدارة الحالة (State Management)

مقترح:
- React Query / TanStack Query
- JWT محفوظ في memory أو secure storage

---

## 10. متطلبات غير وظيفية

- RTL دعم كامل
- متجاوب (Mobile / Desktop)
- تحميل سريع

---

## 11. ما لا يجب على الفرونت فعله

- لا فلترة صلاحيات محلية
- لا تعديل حالة الطلب يدويًا
- لا حفظ بيانات حساسة

---

## 12. ملاحظات للمبرمج

- كل Endpoint موثق في OpenAPI
- أي منطق غير موجود في PRD لا يُفترض
- الهدف: واجهة بسيطة + Backend-driven logic

---

**End of Frontend PRD**

